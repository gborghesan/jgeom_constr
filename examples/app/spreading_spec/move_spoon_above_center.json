{
  "type":"geom_task",
  "monitors":[
    {
      "monitored_expression":{
        "expression":{
          "type":"geometric_expression",
          "description":"Distance between Spoon  Tip (on robot gripper) and Table surface (center)",
          "primitive_1":{
            "entity":{
              "y":0.01,
              "type":"point",
              "x":0.23,
              "z":0
            },
            "reference_frame":"rightarm_gripper"
          },
          "primitive_2":{
            "entity":{
              "y":0,
              "type":"point",
              "x":0,
              "z":0.15
            },
            "reference_frame":"center"
          },
          "expression_type":"point_point_distance",
          "expression_name":"spoon_table_distance"
        }
      },
      "type":"monitor",
      "comparison_type":"in_interval",
      "monitor_name":"is_above_table",
      "lower_bound":-0.015,
      "monitor_var_type":"pos",
      "event_risen":"e_above_table",
      "upper_bound":0.015
    }
  ],
  "auxiliary":[

  ],
  "task_name":"move_spoon_above_center",
  "primary":[
    {
      "type":"constraint",
      "description":"the elbow should be above the table",
      "constraint_name":"elbow_above_table_constr",
      "behaviour":{
        "traj_gen_lower":{
          "type":"trajectory",
          "traj_type":"trapezoidal_with_duration",
          "target":0.1,
          "vel_max":0.1,
          "duration":5,
          "acc_max":0.1
        },
        "type":"behaviour",
        "traj_gen_upper":{
          "type":"trajectory",
          "traj_type":"trapezoidal_with_duration",
          "target":3,
          "vel_max":0.1,
          "duration":5,
          "acc_max":0.1
        },
        "behaviour_type":"position_limit"
      },
      "expression":{
        "expression":{
          "type":"geometric_expression",
          "description":"Distance Projection elbow point - table line Z-direction",
          "primitive_1":{
            "entity":{
              "y":0,
              "type":"point",
              "x":0,
              "z":0
            },
            "reference_frame":"elbow_right"
          },
          "primitive_2":{
            "entity":{
              "type":"line",
              "direction":{
                "y":0,
                "type":"versor",
                "x":0,
                "z":1
              },
              "p":{
                "y":0,
                "type":"point",
                "x":0,
                "z":0
              }
            },
            "reference_frame":"center"
          },
          "expression_type":"projection_point_on_line",
          "expression_name":"elbow_proj_on_table"
        }
      }
    },
    {
      "type":"constraint",
      "description":"spoon contact direction against the table",
      "constraint_name":"spoon_contact_direction",
      "behaviour":{
        "traj_gen_lower":{
          "type":"trajectory",
          "traj_type":"trapezoidal_with_duration",
          "target":-10,
          "vel_max":0.1,
          "duration":5,
          "acc_max":0.1
        },
        "type":"behaviour",
        "traj_gen_upper":{
          "type":"trajectory",
          "traj_type":"trapezoidal_with_duration",
          "target":0.078539816339745,
          "vel_max":0.1,
          "duration":5,
          "acc_max":0.1
        },
        "behaviour_type":"position_limit"
      },
      "expression":{
        "expression":{
          "type":"geometric_expression",
          "description":"Orientation between Spoon and Table surface",
          "primitive_1":{
            "entity":{
              "y":-0.70710678118655,
              "type":"versor",
              "x":0.70710678118655,
              "z":0
            },
            "reference_frame":"rightarm_gripper"
          },
          "primitive_2":{
            "entity":{
              "y":0,
              "type":"versor",
              "x":0,
              "z":-1
            },
            "reference_frame":"center"
          },
          "expression_type":"angle_btw_versors",
          "expression_name":"angle_spoon_table"
        }
      }
    },
    {
      "type":"constraint",
      "description":"the spoon should be above the table (center)",
      "constraint_name":"spoon_over_table",
      "behaviour":{
        "traj_gen":{
          "type":"trajectory",
          "traj_type":"trapezoidal_with_duration",
          "target":0,
          "vel_max":0.1,
          "duration":5,
          "acc_max":0.1
        },
        "type":"behaviour",
        "specification":1.5,
        "behaviour_type":"positioning"
      },
      "expression":{
        "expression":{
          "type":"geometric_expression",
          "description":"Distance between Spoon  Tip (on robot gripper) and Table surface (center)",
          "primitive_1":{
            "entity":{
              "y":0.01,
              "type":"point",
              "x":0.23,
              "z":0
            },
            "reference_frame":"rightarm_gripper"
          },
          "primitive_2":{
            "entity":{
              "y":0,
              "type":"point",
              "x":0,
              "z":0.15
            },
            "reference_frame":"center"
          },
          "expression_type":"point_point_distance",
          "expression_name":"spoon_table_distance"
        }
      }
    }
  ],
  "safety":[
    {
      "constraint_name":"position_limit_r_gripper_motor_slider_joint",
      "type":"constraint",
      "behaviour":{
        "type":"behaviour",
        "specification":2,
        "traj_gen_lower":{
          "target":-0.1,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "traj_gen_upper":{
          "target":0.1,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "behaviour_type":"position_limit"
      },
      "expression":{
        "expression":{
          "joint_name":"r_gripper_motor_slider_joint",
          "type":"single_joint_expression",
          "description":"an example of single joint expression",
          "expression_name":"epr_r_gripper_motor_slider_joint"
        }
      }
    },
    {
      "constraint_name":"position_limit_r_shoulder_lift_joint",
      "type":"constraint",
      "behaviour":{
        "type":"behaviour",
        "specification":2,
        "traj_gen_lower":{
          "target":-0.5236,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "traj_gen_upper":{
          "target":1.3963,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "behaviour_type":"position_limit"
      },
      "expression":{
        "expression":{
          "joint_name":"r_shoulder_lift_joint",
          "type":"single_joint_expression",
          "description":"an example of single joint expression",
          "expression_name":"epr_r_shoulder_lift_joint"
        }
      }
    },
    {
      "constraint_name":"position_limit_r_wrist_flex_joint",
      "type":"constraint",
      "behaviour":{
        "type":"behaviour",
        "specification":2,
        "traj_gen_lower":{
          "target":-2.18,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "traj_gen_upper":{
          "target":0,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "behaviour_type":"position_limit"
      },
      "expression":{
        "expression":{
          "joint_name":"r_wrist_flex_joint",
          "type":"single_joint_expression",
          "description":"an example of single joint expression",
          "expression_name":"epr_r_wrist_flex_joint"
        }
      }
    },
    {
      "constraint_name":"position_limit_l_shoulder_lift_joint",
      "type":"constraint",
      "behaviour":{
        "type":"behaviour",
        "specification":2,
        "traj_gen_lower":{
          "target":-0.5236,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "traj_gen_upper":{
          "target":1.3963,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "behaviour_type":"position_limit"
      },
      "expression":{
        "expression":{
          "joint_name":"l_shoulder_lift_joint",
          "type":"single_joint_expression",
          "description":"an example of single joint expression",
          "expression_name":"epr_l_shoulder_lift_joint"
        }
      }
    },
    {
      "constraint_name":"position_limit_base_footprint_joint_theta",
      "type":"constraint",
      "behaviour":{
        "type":"behaviour",
        "specification":2,
        "traj_gen_lower":{
          "target":-3.14,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "traj_gen_upper":{
          "target":3.14,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "behaviour_type":"position_limit"
      },
      "expression":{
        "expression":{
          "joint_name":"base_footprint_joint_theta",
          "type":"single_joint_expression",
          "description":"an example of single joint expression",
          "expression_name":"epr_base_footprint_joint_theta"
        }
      }
    },
    {
      "constraint_name":"position_limit_l_elbow_flex_joint",
      "type":"constraint",
      "behaviour":{
        "type":"behaviour",
        "specification":2,
        "traj_gen_lower":{
          "target":-2.3213,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "traj_gen_upper":{
          "target":0,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "behaviour_type":"position_limit"
      },
      "expression":{
        "expression":{
          "joint_name":"l_elbow_flex_joint",
          "type":"single_joint_expression",
          "description":"an example of single joint expression",
          "expression_name":"epr_l_elbow_flex_joint"
        }
      }
    },
    {
      "constraint_name":"position_limit_l_wrist_flex_joint",
      "type":"constraint",
      "behaviour":{
        "type":"behaviour",
        "specification":2,
        "traj_gen_lower":{
          "target":-2.18,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "traj_gen_upper":{
          "target":1e-08,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "behaviour_type":"position_limit"
      },
      "expression":{
        "expression":{
          "joint_name":"l_wrist_flex_joint",
          "type":"single_joint_expression",
          "description":"an example of single joint expression",
          "expression_name":"epr_l_wrist_flex_joint"
        }
      }
    },
    {
      "constraint_name":"position_limit_r_gripper_r_finger_joint",
      "type":"constraint",
      "behaviour":{
        "type":"behaviour",
        "specification":2,
        "traj_gen_lower":{
          "target":0,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "traj_gen_upper":{
          "target":0.548,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "behaviour_type":"position_limit"
      },
      "expression":{
        "expression":{
          "joint_name":"r_gripper_r_finger_joint",
          "type":"single_joint_expression",
          "description":"an example of single joint expression",
          "expression_name":"epr_r_gripper_r_finger_joint"
        }
      }
    },
    {
      "constraint_name":"position_limit_l_gripper_motor_slider_joint",
      "type":"constraint",
      "behaviour":{
        "type":"behaviour",
        "specification":2,
        "traj_gen_lower":{
          "target":-0.1,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "traj_gen_upper":{
          "target":0.1,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "behaviour_type":"position_limit"
      },
      "expression":{
        "expression":{
          "joint_name":"l_gripper_motor_slider_joint",
          "type":"single_joint_expression",
          "description":"an example of single joint expression",
          "expression_name":"epr_l_gripper_motor_slider_joint"
        }
      }
    },
    {
      "constraint_name":"position_limit_l_gripper_r_finger_tip_joint",
      "type":"constraint",
      "behaviour":{
        "type":"behaviour",
        "specification":2,
        "traj_gen_lower":{
          "target":0,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "traj_gen_upper":{
          "target":0.548,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "behaviour_type":"position_limit"
      },
      "expression":{
        "expression":{
          "joint_name":"l_gripper_r_finger_tip_joint",
          "type":"single_joint_expression",
          "description":"an example of single joint expression",
          "expression_name":"epr_l_gripper_r_finger_tip_joint"
        }
      }
    },
    {
      "constraint_name":"position_limit_l_gripper_l_finger_tip_joint",
      "type":"constraint",
      "behaviour":{
        "type":"behaviour",
        "specification":2,
        "traj_gen_lower":{
          "target":0,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "traj_gen_upper":{
          "target":0.548,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "behaviour_type":"position_limit"
      },
      "expression":{
        "expression":{
          "joint_name":"l_gripper_l_finger_tip_joint",
          "type":"single_joint_expression",
          "description":"an example of single joint expression",
          "expression_name":"epr_l_gripper_l_finger_tip_joint"
        }
      }
    },
    {
      "constraint_name":"position_limit_r_elbow_flex_joint",
      "type":"constraint",
      "behaviour":{
        "type":"behaviour",
        "specification":2,
        "traj_gen_lower":{
          "target":-2.3213,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "traj_gen_upper":{
          "target":1e-06,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "behaviour_type":"position_limit"
      },
      "expression":{
        "expression":{
          "joint_name":"r_elbow_flex_joint",
          "type":"single_joint_expression",
          "description":"an example of single joint expression",
          "expression_name":"epr_r_elbow_flex_joint"
        }
      }
    },
    {
      "constraint_name":"position_limit_r_gripper_r_finger_tip_joint",
      "type":"constraint",
      "behaviour":{
        "type":"behaviour",
        "specification":2,
        "traj_gen_lower":{
          "target":-0.0001,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "traj_gen_upper":{
          "target":0.548,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "behaviour_type":"position_limit"
      },
      "expression":{
        "expression":{
          "joint_name":"r_gripper_r_finger_tip_joint",
          "type":"single_joint_expression",
          "description":"an example of single joint expression",
          "expression_name":"epr_r_gripper_r_finger_tip_joint"
        }
      }
    },
    {
      "constraint_name":"position_limit_r_gripper_l_finger_joint",
      "type":"constraint",
      "behaviour":{
        "type":"behaviour",
        "specification":2,
        "traj_gen_lower":{
          "target":0,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "traj_gen_upper":{
          "target":0.548,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "behaviour_type":"position_limit"
      },
      "expression":{
        "expression":{
          "joint_name":"r_gripper_l_finger_joint",
          "type":"single_joint_expression",
          "description":"an example of single joint expression",
          "expression_name":"epr_r_gripper_l_finger_joint"
        }
      }
    },
    {
      "constraint_name":"position_limit_r_gripper_l_finger_tip_joint",
      "type":"constraint",
      "behaviour":{
        "type":"behaviour",
        "specification":2,
        "traj_gen_lower":{
          "target":-0.0001,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "traj_gen_upper":{
          "target":0.548,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "behaviour_type":"position_limit"
      },
      "expression":{
        "expression":{
          "joint_name":"r_gripper_l_finger_tip_joint",
          "type":"single_joint_expression",
          "description":"an example of single joint expression",
          "expression_name":"epr_r_gripper_l_finger_tip_joint"
        }
      }
    },
    {
      "constraint_name":"position_limit_laser_tilt_mount_joint",
      "type":"constraint",
      "behaviour":{
        "type":"behaviour",
        "specification":2,
        "traj_gen_lower":{
          "target":-0.7854,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "traj_gen_upper":{
          "target":1.48353,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "behaviour_type":"position_limit"
      },
      "expression":{
        "expression":{
          "joint_name":"laser_tilt_mount_joint",
          "type":"single_joint_expression",
          "description":"an example of single joint expression",
          "expression_name":"epr_laser_tilt_mount_joint"
        }
      }
    },
    {
      "constraint_name":"position_limit_torso_lift_joint",
      "type":"constraint",
      "behaviour":{
        "type":"behaviour",
        "specification":2,
        "traj_gen_lower":{
          "target":-1e-07,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "traj_gen_upper":{
          "target":0.33,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "behaviour_type":"position_limit"
      },
      "expression":{
        "expression":{
          "joint_name":"torso_lift_joint",
          "type":"single_joint_expression",
          "description":"an example of single joint expression",
          "expression_name":"epr_torso_lift_joint"
        }
      }
    },
    {
      "constraint_name":"position_limit_base_footprint_joint_y",
      "type":"constraint",
      "behaviour":{
        "type":"behaviour",
        "specification":2,
        "traj_gen_lower":{
          "target":-100,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "traj_gen_upper":{
          "target":100,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "behaviour_type":"position_limit"
      },
      "expression":{
        "expression":{
          "joint_name":"base_footprint_joint_y",
          "type":"single_joint_expression",
          "description":"an example of single joint expression",
          "expression_name":"epr_base_footprint_joint_y"
        }
      }
    },
    {
      "constraint_name":"position_limit_base_footprint_joint_x",
      "type":"constraint",
      "behaviour":{
        "type":"behaviour",
        "specification":2,
        "traj_gen_lower":{
          "target":-100,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "traj_gen_upper":{
          "target":100,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "behaviour_type":"position_limit"
      },
      "expression":{
        "expression":{
          "joint_name":"base_footprint_joint_x",
          "type":"single_joint_expression",
          "description":"an example of single joint expression",
          "expression_name":"epr_base_footprint_joint_x"
        }
      }
    },
    {
      "constraint_name":"position_limit_head_tilt_joint",
      "type":"constraint",
      "behaviour":{
        "type":"behaviour",
        "specification":2,
        "traj_gen_lower":{
          "target":-0.471238,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "traj_gen_upper":{
          "target":1.39626,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "behaviour_type":"position_limit"
      },
      "expression":{
        "expression":{
          "joint_name":"head_tilt_joint",
          "type":"single_joint_expression",
          "description":"an example of single joint expression",
          "expression_name":"epr_head_tilt_joint"
        }
      }
    },
    {
      "constraint_name":"position_limit_r_shoulder_pan_joint",
      "type":"constraint",
      "behaviour":{
        "type":"behaviour",
        "specification":2,
        "traj_gen_lower":{
          "target":-2.2854,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "traj_gen_upper":{
          "target":0.714602,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "behaviour_type":"position_limit"
      },
      "expression":{
        "expression":{
          "joint_name":"r_shoulder_pan_joint",
          "type":"single_joint_expression",
          "description":"an example of single joint expression",
          "expression_name":"epr_r_shoulder_pan_joint"
        }
      }
    },
    {
      "constraint_name":"position_limit_head_pan_joint",
      "type":"constraint",
      "behaviour":{
        "type":"behaviour",
        "specification":2,
        "traj_gen_lower":{
          "target":-3.007,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "traj_gen_upper":{
          "target":3.007,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "behaviour_type":"position_limit"
      },
      "expression":{
        "expression":{
          "joint_name":"head_pan_joint",
          "type":"single_joint_expression",
          "description":"an example of single joint expression",
          "expression_name":"epr_head_pan_joint"
        }
      }
    },
    {
      "constraint_name":"position_limit_r_gripper_joint",
      "type":"constraint",
      "behaviour":{
        "type":"behaviour",
        "specification":2,
        "traj_gen_lower":{
          "target":0,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "traj_gen_upper":{
          "target":0.09,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "behaviour_type":"position_limit"
      },
      "expression":{
        "expression":{
          "joint_name":"r_gripper_joint",
          "type":"single_joint_expression",
          "description":"an example of single joint expression",
          "expression_name":"epr_r_gripper_joint"
        }
      }
    },
    {
      "constraint_name":"position_limit_l_shoulder_pan_joint",
      "type":"constraint",
      "behaviour":{
        "type":"behaviour",
        "specification":2,
        "traj_gen_lower":{
          "target":-0.714602,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "traj_gen_upper":{
          "target":2.2854,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "behaviour_type":"position_limit"
      },
      "expression":{
        "expression":{
          "joint_name":"l_shoulder_pan_joint",
          "type":"single_joint_expression",
          "description":"an example of single joint expression",
          "expression_name":"epr_l_shoulder_pan_joint"
        }
      }
    },
    {
      "constraint_name":"position_limit_r_upper_arm_roll_joint",
      "type":"constraint",
      "behaviour":{
        "type":"behaviour",
        "specification":2,
        "traj_gen_lower":{
          "target":-3.9,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "traj_gen_upper":{
          "target":0.8,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "behaviour_type":"position_limit"
      },
      "expression":{
        "expression":{
          "joint_name":"r_upper_arm_roll_joint",
          "type":"single_joint_expression",
          "description":"an example of single joint expression",
          "expression_name":"epr_r_upper_arm_roll_joint"
        }
      }
    },
    {
      "constraint_name":"position_limit_l_gripper_r_finger_joint",
      "type":"constraint",
      "behaviour":{
        "type":"behaviour",
        "specification":2,
        "traj_gen_lower":{
          "target":0,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "traj_gen_upper":{
          "target":0.548,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "behaviour_type":"position_limit"
      },
      "expression":{
        "expression":{
          "joint_name":"l_gripper_r_finger_joint",
          "type":"single_joint_expression",
          "description":"an example of single joint expression",
          "expression_name":"epr_l_gripper_r_finger_joint"
        }
      }
    },
    {
      "constraint_name":"position_limit_l_upper_arm_roll_joint",
      "type":"constraint",
      "behaviour":{
        "type":"behaviour",
        "specification":2,
        "traj_gen_lower":{
          "target":-0.8,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "traj_gen_upper":{
          "target":3.9,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "behaviour_type":"position_limit"
      },
      "expression":{
        "expression":{
          "joint_name":"l_upper_arm_roll_joint",
          "type":"single_joint_expression",
          "description":"an example of single joint expression",
          "expression_name":"epr_l_upper_arm_roll_joint"
        }
      }
    },
    {
      "constraint_name":"position_limit_l_gripper_l_finger_joint",
      "type":"constraint",
      "behaviour":{
        "type":"behaviour",
        "specification":2,
        "traj_gen_lower":{
          "target":0,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "traj_gen_upper":{
          "target":0.548,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "behaviour_type":"position_limit"
      },
      "expression":{
        "expression":{
          "joint_name":"l_gripper_l_finger_joint",
          "type":"single_joint_expression",
          "description":"an example of single joint expression",
          "expression_name":"epr_l_gripper_l_finger_joint"
        }
      }
    },
    {
      "constraint_name":"position_limit_l_gripper_joint",
      "type":"constraint",
      "behaviour":{
        "type":"behaviour",
        "specification":2,
        "traj_gen_lower":{
          "target":0,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "traj_gen_upper":{
          "target":0.09,
          "type":"trajectory",
          "traj_type":"constant"
        },
        "behaviour_type":"position_limit"
      },
      "expression":{
        "expression":{
          "joint_name":"l_gripper_joint",
          "type":"single_joint_expression",
          "description":"an example of single joint expression",
          "expression_name":"epr_l_gripper_joint"
        }
      }
    }
  ]
}